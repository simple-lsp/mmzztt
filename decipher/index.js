const CryptoJS = require('crypto-js')

//----通过 mzt.log 代码获取的解密信息----
let items = [
  // {
  //   id: '66192',
  //   commentPrefix: 'f14a4b6ea8f428a2f3da82533a21477ae2b792127457a8bbc8ca111555584794',
  //   comment: 'c3778ffa3dd714aa85cab10fc9889145c4ad3367e5568a35b6ec3829c8ce6940a738146ceb7657c7b5360505ed14af774f59b9230c0da9ecacb6711a5b2ab0cb10fb8d5304de20feed747fc4f71232e4e8005cb4c915f946e8d00f9a212afb780671f245b26ed5000e47262b3f4f6b01844e1eaad6eb3ee04f2a714e6cb05d30829ec6ee8539f91bdf4dcec1827b2f1b8504b1aea830b76f78a663d2719050c5cd07b0b91b03fee7d771e3c5f738e400632fbf81bc6b506e407dba5624634af126aa9ee2cf9bab8656741dc197602d6efcff813fb637f9159ca3eb4251a57e38001100f262435481b3f2eceb96985b8cff4a2dec5594174195fadc398d86d4f7a8873a784da343ab49beb070f2bd6bcc5ba166ece35ccf8f5cf9e7a5a45c55bc1845f1d6cc0175138bb8b55318403159c2161cf3283a6692374494b889872202d748a8f20e31913284210cd635bfc01c96171bd2db4e2eaa37ebaf9d8ec94ec366d35f96e963df128a647af7f621a807cad3a2354e3c14addc0102c13cc0b615915a944998333990d0d349404505983593880b546332f6a0156f9e3dae009646240c3b65c2fd5baa6c38a012e817095813da3b6baf94b11d8de621dd316d4e9d3f1dd700e1d9239c911ee77296199fdfc02636facc6f23fe178c9ebc87bc24029031866145d76ff699ec847195f70a6ae6a9f51c39a4b14c0d8f5ec7f87d65803c378f724021652dd163a0ff960da8846712d6d354ac324e46477716db29b6f4344401c7934e88ad2560edd3178a956d38d72eab3c3f620bc37324480bc431fb02777b8288d3131805439032e05be215a3bfaab387460b1e582eff7b21f793f7671ad055d7494d393323537fac1481d3ed9f9df67a8b632ec0c8ed5e456e3b80b7c9b4d7bd24d6f9e486a33bc5f86cbe6af49e124744005f9ecb83479740b8baf7c7b5adabda847e32ba69201cce3877c5eb171fe69dd7bf18b772bccfe6b71e2f8907c32aa27da1b48d250e6282ce4d137c9ac7cc872ba623c00942eef3b44c5f73f835f27d5c0a361b5d8227221d2934d659d28504c694e4b5929a28633877439f07bb771590d29d39600eeeb21e7f512896f31b0478ecc64756c687b91c3a92dca158062123217070d7937d591867910a8adbef4e608edb78e990a7a9677340ad3c20a27f04014edb44e4abcfe88c974a689aac5799f7bf670e070f13c8f48655f706b9a773951e94abd917d53dc33d40b99040e345268c4986bdf3d1c98cea7afc587649c778a3816f1d2a785b65662fb89a18a2dfed47524b778e50b85c2e1ceb793420efe671ae9e67596ade09b6e49080f21bd0d878354326642d6897f47728c8038a29f59178e02c9fb07468967ca6cee9cdf8252364d5cfadc8f7db2b94896933dd10fbbaad74a9817faa6459435364351772024d1197890463c5826e0ab65157a53ab479cf65394c5f606696593d1a583583d220b204487a5fcad2bba07629c83943474adf106e0087dff0647d1502ad62b852f7b8371007bd63bb1d316d97dfbfb43daa2b32291ce9a1dbf617b797864fb672a767612b59e34a339c6451838c7f1f26f6a06d7f3729651a76b23d35879182903abbc57ee7f690c61a52b6a5e16a6972811f2feeb8d2c905c14b8ae22bdbd7f072bab6f34a3f5831692f6822010a27a36d28d97fecd8f1090d1bad46478a449d7c1795c5c58a51343c12a4e4bcd7bdb7c989732c65512008',
  //   key: '661929e07a0967b33524b1702260a9b97b8e8',
  //   iv: '0002000625000302'
  // },
  // {
  //   id: '67263',
  //   commentPrefix: '553d3c4ca030e0ae6d432950aa0c434fe2b792127457a8bbc8ca111555584794',
  //   comment: '4adba0c0cf3b00fbfe90c690e35b48c9a0848e75a312369978429a6504b398527334fb07d3071f2d9947d2b3b45b60e6caecc2dacc3fa7c2e4e172fcbfb73a51ff66a78f0de46531319d49af881a7cbb5d38fa161e40698c5fb4c930c08ef9dfab543f58d66e215b1fad79060f6c39ae9449d9a91e934dc03fc7a9cda4eb6849458023dbbc5dcb4cacfbce86d7a04f80a2ef9e31ef5e589a118281dbf6bdc4c632dab153556fa278bdd119de9fd4afa05e77f1770c2850dd28d1e038b50517d12e2953e3e9da74f93c99e2636c03ba770651c5fd12a1b6a3db03aabaf7b11c67a681c820722f837207b397a8754460689e8f00603bd7597a0cbcb1a8b08b19f555d3297e0afada30f9fc3844c3c1d3fb45f7138a57310573ee0b5cb3e9d38460a97b83ac87cbc5dd5e1af1ea5ed0c56cfaebda32b91175b19756c490378f6713e49af0a10122358614f107cd068f57f7646c42b7fb2ae53b48292f08535d8adab1049f9cc23e35169f2223d78126708d0c9eef2a573d3ec0d1f8d56dcbdb04dbb439ca602f16908a0b10abb00119db5ee86d32b5d9813c877010a3590d4576fd7000696a6f7de3bb1493f8bafb67a96f1000800020b60a7581cc3d0b0df4f9ecdefa2ab2ad3de9f2f7a2a6f7b0b99bcc62c71823cd91dcd2ac8075fc5125b829a511e241a946ae4637b4d72a2df764f43e0b5ba48d933bf7485a9daaea10ee3aa9ecd930248581b644fba4a840634ca24be01b1597e5844a69d131b842578442a821184377b36f68a29e4c7045ee3391f1cc77d45b0b4b111169c87859b609a8e95987278410296fcd587abc2d59f78d1c18a59d7d31187b52566d730d89dab37ae0a6eb7215b76a84f7dd866481606663fcc40f93a76f3eaf3ba1c85c50ab089da872651e30a37b9cc97503a06702e4a20eda67e1c340bde679b4aa0328f2dbe055ef5fca301c6081faf03b8085b2855e611409bb496aec8a7eb1a65e0e96911768b8826e26b79765f85dae21068198c8b76fbd3def37c54ddfe9bf007b40be3c4b51077053c2b99f0e1e7bda69ce656586641078d514b16971e69103034f967dcb9c9c485bfb96b2e2cd176c385bfbaf0fd71b4ce6459039e29ada79d207de18f5d640d92887662eff4d7325a394b94c0caaf510fa4a2cb87a6269cbc626db8fe0c359ab33bdd38759b0c63fb471ab7c5b7f24444bc1a7bf5774fa12c6e48d3046bcb734de991d2821fcde440e8ee3aca3fa0ae0e1e89742ec2ccf806705c134a820bea78e2553e2de81d479430b9c01e0184080434e71064aa6985f44d0bc85b8dd271902324e7bd010c9a7d5953e484cfee7ba96ef1395527bb0bb5a7b407cb02426da33a770950cf998d23f1cd230b496d17e18599db1793271f69c3eb2522bb5ffdff263347d53f9c056285dc2ccf0782e048046496087bc1dbcbc27bccfe00422ff72a3337583b55037bfcc7af480ee3451a4195a65cd50d5670505eb6b87c7c10e821b2a0459a5c74b4e1932410e853f427b93a6e6d4b8c94fef0342f9428ff2712ba3bdaa62540d9b81f7af5090f46dd9aafa1361c34d68734809212fe36052006f3bd8c2a99aeaf2032b7f9410cdb5a547bbb92d308be92495fd0fc5c6437c767eca58f7b4b464cff65542135f448399e3c78dc51a14f744465bb24886828dd8d5887117d3638bd879450b8c997b222439239d9c94caf579bb84fe',
  //   key: '672639e07a0967b33524b1702260a9b97b8e8',
  //   iv: '1033307630317362'
  // },
  // {
  //   type: 'xza',
  //   id: '66854',
  //   commentPrefix: '95cf4e12da17ffdb996a6231793d8d994a5727c169edfc733f1c4f12b9c6d871',
  //   comment: 'dbd93d9e4ab66b55e8cbe7044b6e347d8dd7436882f365e9303b766574c60d78872f02299d763c3738cd59f45cbe42607a5944192de3f2ad3a5d2a8f65c5e19d3c05e909cf6910400f2d9277a838eeadaa87e9266d26162da40188a9f198faab63b3e46880139a1584786796b1dc1ae88af5c8c84d74ae3fff878a419f4101ac105b711817210134fbccd62c29f596a819e9ada31ed8dae013ccd322f179e2031f0d0730771c39240b1796d376c95823baf5a2f951989cc0f3a7827e11a860d1d22faa48439d17fc49a1078a4acb7c97bca7ba22debbbf1c7715a4bfdb53a2d85d5bd0005aade148cd116042250f3820f7d0083e5a7653f37621f8c1f96e44d0a521891ce2feef9ab5104a562ed9653a6cf4fcd06f8d8a471609280d8b8a33e18170e9ec34a09f6ad513ffed553df0216913776b3472fdf196a627864720ebc9815283625fcecba6255ee905401830ff93e3ba104b6e0f740caf70023e1fb0c6ebf0cda5b1c0c2f142ecdfadac908b54c84b00f883883dd08667fb78e8b7e1746cdd04ce48e034ecce45af1ddaecf7e0598241060da879db564a89e4b917db824c4497cebd65cfd3996588432f74116265fc045d254f4d0f31a19049c4ff26522bfe81d1d79b4d724d7b198ea3d7bcd1a09e8d0f00143de6530dd5b9fe2102ad2f86bd479e742b1fdf9e21d077e0263163cd8ec32a3a906186a37eefba7b9bf07ec80831e280abafd76eff097f681ea6d52e3e1cc01cacdb15a77af52bbeed714aaae2667882008087c0af345afda654d079c2a9fdc1872592d99fc345077f5510ee821387d3bd234f6fb7eea2678faecb7fab9e17e74d8c15fce2594886aab5e76e6511d2030d903f99168d69dcc50e9d54cfc2b8dcad849e50ae4bfd7aba9615708c14629f0c43d9171beff61f7b85c66b12a343905ce8527adf344e83f8b880fd38aff2f59b2c7fc022eb947e73df74de449f75fbcf1ca1b7e3140d1cc84e4a53326538c6365b84854848c505dfce073373c9bf5b55bb7a855dbe9f7131e67705661cf59bf95fb7682d9085650c71c00e414d1b507f6e27a0605c83fafbe512d3b7729abfc4f1f791ae318625a146a9ed5bfe09fa873d39f6fe731c615035bf0bb8a3b848709ad698200beda8be9394c0c870b4d149472f700c554fa998e354266e17e4c07f037b73608f3fcf7e5bd2fafb931e592059d7d10ecdeb7111b5',
  //   key: '6685458530ddce06616b14c417a663ff94942',
  //   iv: '0224246247284561'
  // },
  // {
  //   type: 'gol',
  //   id: '66854',
  //   commentPrefix: '81594a76804be1ce24b36829be3bb5bdfb703eb628a02a4551535a2674d4d107',
  //   comment: 'd3896d0b6a01c6f42e1b626bc8a9eb1a08780c9e47ac394bfc85b6422381ae9070f22193c9b2a32d97a2509e6b80f23f7a7bd644507dd6a72e13bc1bdd96088e70f2556fded53216f8e71b13b96ade01271e44e9662fa1290386c2ea91e454c1c14844ee803bcfad39ef4e70590f9b9116fb4853316b11908b826211672f45aae484f440754989554ab664d61b8dab4ea375f8144d93efb37c4678f73a5093ddfac8d505a038b2b853fd145e0c41b63e423206c1abe24cbadbc4fc4eca647a324488f759b7c3301561a83d9402cd461444fdfcd4094f0acc7f08d8d2dd5ae7506122e10b731d2a09007c3db705a872439b463e7b8f413ab42258ebb306d3a51caf8ae32345fabfd2bc86876957d5600fd93ccc26c5eecebf8995e1e5f7e6524cb7db93fca6c407faed2b096917699160afa67dde0537735b8b79a0c001c17f352b10f0a3b1877862d285e36caa331febffedafb04885838c53002cb410fe5464ad422e9847d742f10a093f924f98e4e4c9db2924fe1911b5965953d4ddfd8c1f964b2359291aea9effb5962ac3f5764e4aabb7b2bfe298e0b2c7d043fc5fe5ca0e6a5c7a7108b1b4eb1681a34a43fee8b7652e7212ec798b5a282e60a88d2308df3b2533f62201a65a3b2513ef919b53cf5e80153e525e1342652114d268f3e2c1a077bf0b349bf42f8d6eddc86384fd32f6c9469e311ae8e7ba21f9c9691097e00b1686fa1b0e3f9d5247d2b7f90beeeb93b167480fb514e41ef49ef0356e587183fb06046912fcb3ee8f653558e575504441cb5d9ec0147daf26d39a03424423f153f3064a9694eead593abb28838b8d539054910504008b23ca7ac6980f6c6ce1412e15a21c17cd96715aab83b4ab6d3daa0d0b1630eb1f81b949d437e3c8d1081c8af4baab5c53dd280cad601839baac8b0b83893bd1180a2342bd588479efd353bbd91e64376be43a4e16e134165d22eb0e7c829411fea1e400c10f180cc12f292e7b5b15e23fa7933d2a50f5480a8bd90c000228032188c1d7d9ab6263b1ed6785bc153f1f76e91ecd5375dc7439062bc9077ef53da56e46348c8f9af54ad06738b6f1c563f4b4073424ad3a93a9edf605a969321f0619fdb127c50782945b250fa8e637330c3c02934d1bff63419b469ea0ec07135240e8f152a43b0ce9a9a9e6fb6a8af1cbb67bf4ac9aa3e15138dec5c5b344c9109e149db857b253',
  //   key: '66854679b480ca9027dd8f81468f0763d31f8',
  //   iv: '0224246247284561'
  // },
  // {
  //   'type': 'xsk',
  //   'id': '67099',
  //   commentPrefix: '912ae8fb821eea291f0d18087f2ad072708a9310289b38a2dd4e50422d5c28c9',
  //   'comment': '55c925d76606c7ede969f9ad6ccadcd998754831606274144d44473c4cbbbb701f598e8de8eb5c2dfa7c192794750f459b1b0cb7089715ddf2ebfd122f5ed26ed62adba1d6a2d543546ec4272cf17e65d9ed6a243dff6a6233776970db8efd470a43e3f211f741139b88384087a3549397457c9564c4d134cfabb64ee102894dff8a4da9b89e7d8b0df4e51c3aa8acd9ed6cacc2f8cdd2964b5c666e1efc30819ff32f8703f23e3a1e334b2488ffed1635a7fecf26714eb80a14c5dfbc556005b06c24f95728660d9b6c3181b910856460c0405c7525aa6bfda6515d79e6728f7d5c40054c5a8156522a70b5833719bb0b07f7aaad4aac4bdde3057bc477d372bf7a60df7a9e59227b5cd2e5a01a3e08f064c45b6ade5dde4ac2ff6c85a77a9d64b5ebe728d39be4236b8d183e961dddebe1d9a95e94964e86518255375f346f0d7711f0601f3146a405a3112cf60afb17c639cb79deb83c0d1de5b26a30c14c9c54c0b0ec1379f1fc632daaf60da24129c85fffaacc51778edf49cac77559e6e39dfa3fcfa9fb196dcc8d332bc772417d95d693482ff6f66341930022c639ae091a8ce9789e91dc60e148b7b63508e93ee20b9d6408c990cd27f512c12fd7b21d2ec4ac313ba03b65ea0ebd9593764f5e5b22f1c5d61982124702353eb784389118fd0cb97eebf89367127e60e0882d0d8b06e0c8d7c97c069f23abea8d934463dbe6f3e5a885d12fc820d31c5f83b584ca092358c288c22d40b289f03161331992e7ad8f9140835751ed5b79eef56ffdc659a9aac00772d67c699a2fd3ec428760adce2df549d60518a34ba244489389b82e49ea441646e1e035f0aa8d31aaf10e54159fdcc0cdc9d0d69908d731dc85b1ebf981b0da426b79d1c1b5ed20fc1ba2beaeef604c8eb31c4d6ae414eabd3ca55ec1eea09e33f5b2b3ce23cb8a1288e5ed623dccc080632186358c371fa1a78036f8d3549ee98b7d396a64e2dcd7a3ae0055d35cd6b23067f80a50f232026261959410f933fef0ed869eba20b8cf5be9a895865eb8c9d538af475106cb812c0b60f60be8ed44609672c216d05074e383f826907e2248dfe1a6465b06cd3b67b6a3b6d52d28a29600545da81a5f032ad59c9129394c0ed73f6c69bf776344cc18aeddc5dcf3adfd1ecb61f9fe29b555ca6ae0fa22ea5412dffe34ae91c2355215a33a98201b0d6aaec3084058f377d880f681cf52603b193988c51d957033b5eb9161193ee604e8825319d114c155097795dbf6b591f5f117146c2fe8afd71bfc2c8c51cab7c0a8d0a140ea34f418bdc75bec026f76ed11613c44d571d1a2663959e2649bda7162df16b23a249c44ccaaae0047763de6ac61998ca4c4ceee3741e7d0d67dc0d0dc774e888500ef68ce69fdbb37b070fcefe8856c364dd3c290e66f5b0254ebb349a0690f8f35172af7ba4249af049ca9489208c658af0857bd6be4a4ead6fdfcbe3792705b9801a3c1664e24ad4743789cee35977584c70db3b735cfe3ad2f7c35d2f11e280d4fae0154be733a8bd33e20971c89c40322e3243888ecf6dea3d2265ef615120651324d2f590575f1d043d370e1b11986ea6dae6be9ec706bddc4817b31aa098d354f17ef446d2558a4db646b8459a0d99020e9af8690cbcdfb8cbb73ec8947e327ebd3a619f03eda70b6549d2a3528f161c0a2ecc6aa11093cf2078f6d1312e357ba',
  //   'iv': '1134143401762420',
  //   'key': '67099ba76d07137a6d167f3754fd81f700220'
  // }
]

function decipher(info) {
  let hex = CryptoJS.enc.Hex.parse(info.comment)
  let base64 = CryptoJS.enc.Base64.stringify(hex)
  let md5 = CryptoJS.MD5(CryptoJS.enc.Utf8.parse(info.key)).toString().substr(8, 16)
  let key = CryptoJS.enc.Utf8.parse(md5)
  let urls = CryptoJS.AES.decrypt(base64, key, {'iv': CryptoJS.enc.Utf8.parse(info.iv), 'mode': CryptoJS.mode.CBC, 'padding': CryptoJS.pad.Pkcs7})
  return JSON.parse(CryptoJS.enc.Utf8.stringify(urls))
}

// let results = Object.values(items).map(info => ({id: info.id, urls: decipher(info)}))
// console.log(results)

module.exports = decipher
